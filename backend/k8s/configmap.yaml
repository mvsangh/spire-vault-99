apiVersion: v1
kind: ConfigMap
metadata:
  name: backend-config
  namespace: 99-apps
data:
  # Application
  APP_NAME: "SPIRE-Vault-99 Backend"
  APP_VERSION: "1.0.0"
  DEBUG: "false"

  # Server
  HOST: "0.0.0.0"
  PORT: "8000"

  # SPIRE
  SPIRE_SOCKET_PATH: "/run/spire/sockets/agent.sock"

  # JWT-SVID Configuration for Vault Authentication
  JWT_SVID_AUDIENCE: "openbao,vault"  # Comma-separated list of audiences

  # Vault (OpenBao)
  VAULT_ADDR: "https://openbao.openbao.svc.cluster.local:8200"
  VAULT_CACERT: "/vault/tls/ca.crt"  # Path to OpenBao CA certificate
  VAULT_KV_PATH: "secret"
  VAULT_DB_PATH: "database"
  VAULT_DB_ROLE: "backend-role"

  # PostgreSQL
  DB_HOST: "postgresql.99-apps.svc.cluster.local"
  DB_PORT: "5432"
  DB_NAME: "appdb"
  DB_POOL_SIZE: "10"
  DB_MAX_OVERFLOW: "10"
  DB_POOL_TIMEOUT: "30"
  DB_CREDENTIAL_ROTATION_INTERVAL: "3000"  # 50 minutes
  DB_ECHO: "false"

  # JWT Authentication
  JWT_SECRET_KEY: "dev-secret-key-change-in-production"
  JWT_ALGORITHM: "HS256"
  JWT_ACCESS_TOKEN_EXPIRE_MINUTES: "60"

  # Password Hashing
  BCRYPT_ROUNDS: "12"

  # GitHub API
  GITHUB_API_URL: "https://api.github.com"

  # Logging
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"
